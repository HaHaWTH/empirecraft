From edcb521d2c8577f2bc73ee507ed07bd0c9fcef06 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Thu, 18 Dec 2014 22:48:46 -0500
Subject: [PATCH] Add BlockBreakNaturally Event

To give reliable control over all blocks dropping to world to restore custom item meta
---
 src/main/java/net/minecraft/server/Block.java                 | 1 +
 src/main/java/net/minecraft/server/PlayerInteractManager.java | 1 +
 2 files changed, 2 insertions(+)

diff --git a/src/main/java/net/minecraft/server/Block.java b/src/main/java/net/minecraft/server/Block.java
index 785106dd86..5570a666ab 100644
--- a/src/main/java/net/minecraft/server/Block.java
+++ b/src/main/java/net/minecraft/server/Block.java
@@ -383,6 +383,7 @@ public class Block {
                 world.captureDrops.add(entityitem);
             } else {
                 world.addEntity(entityitem);
+                new com.empireminecraft.customevents.BlockBreakNaturallyEvent(MCUtil.toLocation(world, blockposition), (org.bukkit.entity.Item) entityitem.getBukkitEntity()).callEvent(); // EMC
             }
             // CraftBukkit end
         }
diff --git a/src/main/java/net/minecraft/server/PlayerInteractManager.java b/src/main/java/net/minecraft/server/PlayerInteractManager.java
index fa7a16f66c..7f003ad645 100644
--- a/src/main/java/net/minecraft/server/PlayerInteractManager.java
+++ b/src/main/java/net/minecraft/server/PlayerInteractManager.java
@@ -359,6 +359,7 @@ public class PlayerInteractManager {
                 if (event.isDropItems()) {
                     for (EntityItem item : world.captureDrops) {
                         world.addEntity(item);
+                        new com.empireminecraft.customevents.BlockBreakNaturallyEvent(MCUtil.toLocation(world, blockposition), (org.bukkit.entity.Item) item.getBukkitEntity()).callEvent(); // EMC
                     }
                 }
                 world.captureDrops = null;
-- 
2.13.0

