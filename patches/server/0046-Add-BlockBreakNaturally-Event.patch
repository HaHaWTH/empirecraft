From f35417c2bb5b62fe27ca2fc76ada4f4f9fd10673 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Thu, 18 Dec 2014 22:48:46 -0500
Subject: [PATCH] Add BlockBreakNaturally Event

To give reliable control over all blocks dropping to world to restore custom item meta
---
 src/main/java/net/minecraft/server/Block.java                 | 1 +
 src/main/java/net/minecraft/server/PlayerInteractManager.java | 1 +
 2 files changed, 2 insertions(+)

diff --git a/src/main/java/net/minecraft/server/Block.java b/src/main/java/net/minecraft/server/Block.java
index 3523109603..b495819eb4 100644
--- a/src/main/java/net/minecraft/server/Block.java
+++ b/src/main/java/net/minecraft/server/Block.java
@@ -383,6 +383,7 @@ public class Block {
                 world.captureDrops.add(entityitem);
             } else {
                 world.addEntity(entityitem);
+                new com.empireminecraft.customevents.BlockBreakNaturallyEvent(MCUtil.toLocation(world, blockposition), (org.bukkit.entity.Item) entityitem.getBukkitEntity()).callEvent(); // EMC
             }
             // CraftBukkit end
         }
diff --git a/src/main/java/net/minecraft/server/PlayerInteractManager.java b/src/main/java/net/minecraft/server/PlayerInteractManager.java
index dda83700f3..bc36a27f09 100644
--- a/src/main/java/net/minecraft/server/PlayerInteractManager.java
+++ b/src/main/java/net/minecraft/server/PlayerInteractManager.java
@@ -361,6 +361,7 @@ public class PlayerInteractManager {
                 if (event.isDropItems()) {
                     for (EntityItem item : world.captureDrops) {
                         world.addEntity(item);
+                        new com.empireminecraft.customevents.BlockBreakNaturallyEvent(MCUtil.toLocation(world, blockposition), (org.bukkit.entity.Item) item.getBukkitEntity()).callEvent(); // EMC
                     }
                 }
                 world.captureDrops = null;
-- 
2.14.2

