From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Mon, 25 Jun 2018 22:30:08 -0400
Subject: [PATCH] EntityRandomStrollEvent

---
 .../ai/goal/PathfinderGoalRandomStroll.java   | 104 ++++++++++++++++++
 1 file changed, 104 insertions(+)
 create mode 100644 src/main/java/net/minecraft/world/entity/ai/goal/PathfinderGoalRandomStroll.java

diff --git a/src/main/java/net/minecraft/world/entity/ai/goal/PathfinderGoalRandomStroll.java b/src/main/java/net/minecraft/world/entity/ai/goal/PathfinderGoalRandomStroll.java
new file mode 100644
index 0000000000000000000000000000000000000000..7387fba5e0b5b6c9a270aa1359e142a112c19a9e
--- /dev/null
+++ b/src/main/java/net/minecraft/world/entity/ai/goal/PathfinderGoalRandomStroll.java
@@ -0,0 +1,104 @@
+package net.minecraft.world.entity.ai.goal;
+
+import java.util.EnumSet;
+import javax.annotation.Nullable;
+
+import net.minecraft.server.MCUtil;
+import net.minecraft.world.entity.EntityCreature;
+import net.minecraft.world.entity.ai.util.RandomPositionGenerator;
+import net.minecraft.world.phys.Vec3D;
+
+public class PathfinderGoalRandomStroll extends PathfinderGoal {
+
+    protected final EntityCreature a; EntityCreature getEntity() { return a; } // Paper - OBFHELPER
+    protected double b; double getX() { return b; } // Paper - OBFHELPER
+    protected double c; double getY() { return c; } // Paper - OBFHELPER
+    protected double d; double getZ() { return d; } // Paper - OBFHELPER
+    protected final double e;double getSpeed() { return e; } // Paper - OBFHELPER
+    protected int f;
+    protected boolean g;
+    private boolean h;
+
+    public PathfinderGoalRandomStroll(EntityCreature entitycreature, double d0) {
+        this(entitycreature, d0, 120);
+    }
+
+    public PathfinderGoalRandomStroll(EntityCreature entitycreature, double d0, int i) {
+        this(entitycreature, d0, i, true);
+    }
+
+    public PathfinderGoalRandomStroll(EntityCreature entitycreature, double d0, int i, boolean flag) {
+        this.a = entitycreature;
+        this.e = d0;
+        this.f = i;
+        this.h = flag;
+        this.a(EnumSet.of(PathfinderGoal.Type.MOVE));
+    }
+
+    @Override
+    public boolean a() {
+        if (this.a.isVehicle()) {
+            return false;
+        } else {
+            if (!this.g) {
+                if (this.h && this.a.dd() >= 100) {
+                    return false;
+                }
+
+                if (this.a.getRandom().nextInt(this.f) != 0) {
+                    return false;
+                }
+            }
+
+            Vec3D vec3d = this.g();
+
+            if (vec3d == null) {
+                return false;
+            } else {
+                this.b = vec3d.x;
+                this.c = vec3d.y;
+                this.d = vec3d.z;
+                this.g = false;
+                return true;
+            }
+        }
+    }
+
+    @Nullable
+    protected Vec3D g() {
+        return RandomPositionGenerator.a(this.a, 10, 7);
+    }
+
+    @Override
+    public boolean b() {
+        return !this.a.getNavigation().m() && !this.a.isVehicle();
+    }
+
+    @Override
+    public void c() {
+        // Paper start
+        org.bukkit.Location loc = MCUtil.toLocation(getEntity().getWorld(), getX(), getY(), getZ());
+        com.destroystokyo.paper.event.entity.EntityRandomStrollEvent event = new com.destroystokyo.paper.event.entity.EntityRandomStrollEvent(getEntity().getBukkitCreature(), loc, getSpeed());
+
+        if (!event.callEvent()) {
+            return;
+        }
+        loc = event.getLocation();
+        getEntity().getNavigation().a(loc.getX(), loc.getY(), loc.getZ(), event.getSpeed());
+        // Paper end
+    }
+
+    @Override
+    public void d() {
+        this.a.getNavigation().o();
+        super.d();
+    }
+
+    public void h() {
+        this.g = true;
+    }
+
+    public void setTimeBetweenMovement(int i) {
+        this.f = i;
+    }
+}
