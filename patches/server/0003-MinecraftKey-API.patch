From 8460339788bfacee33054ada728f27fe37c00da4 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Mon, 21 Nov 2016 17:12:56 -0500
Subject: [PATCH] MinecraftKey API

---
 .../java/net/minecraft/server/MinecraftKey.java    | 51 ++++++++++++++++++++++
 .../java/org/bukkit/craftbukkit/CraftServer.java   |  9 ++++
 2 files changed, 60 insertions(+)

diff --git a/src/main/java/net/minecraft/server/MinecraftKey.java b/src/main/java/net/minecraft/server/MinecraftKey.java
index 6dad3f5..be7831f 100644
--- a/src/main/java/net/minecraft/server/MinecraftKey.java
+++ b/src/main/java/net/minecraft/server/MinecraftKey.java
@@ -64,4 +64,55 @@ public class MinecraftKey {
     public int hashCode() {
         return 31 * this.a.hashCode() + this.b.hashCode();
     }
+
+    // EMC start
+    private com.empireminecraft.MinecraftKey bukkitKey;
+    public com.empireminecraft.MinecraftKey getBukkitKey() {
+        if (bukkitKey == null) {
+            bukkitKey = new CraftMinecraftKey();
+        }
+        return bukkitKey;
+    }
+
+    private final class CraftMinecraftKey implements com.empireminecraft.MinecraftKey {
+        @Override
+        public String getGroup() {
+            return MinecraftKey.this.getKeyGroup();
+        }
+
+        @Override
+        public String getName() {
+            return MinecraftKey.this.getKeyName();
+        }
+
+        @Override
+        public int hashCode() {
+            return MinecraftKey.this.hashCode();
+        }
+
+
+        @Override
+        public boolean equals(Object o) {
+            if (this == o) {
+                return true;
+            }
+            if (o == null || getClass() != o.getClass()) {
+                return false;
+            }
+
+            CraftMinecraftKey that = (CraftMinecraftKey) o;
+            return getGroup().equals(that.getGroup()) && getName().equals(that.getName());
+        }
+
+        @Override
+        protected Object clone() {
+            return new MinecraftKey(getGroup(), getName()).getBukkitKey();
+        }
+
+        @Override
+        public String toString() {
+            return MinecraftKey.this.toString();
+        }
+    }
+    // EMC end
 }
diff --git a/src/main/java/org/bukkit/craftbukkit/CraftServer.java b/src/main/java/org/bukkit/craftbukkit/CraftServer.java
index 2cb0bae..de4828e 100644
--- a/src/main/java/org/bukkit/craftbukkit/CraftServer.java
+++ b/src/main/java/org/bukkit/craftbukkit/CraftServer.java
@@ -21,6 +21,7 @@ import java.util.logging.Level;
 import java.util.logging.Logger;
 import java.util.regex.Pattern;
 
+import javax.annotation.Nonnull;
 import javax.imageio.ImageIO;
 
 import net.minecraft.server.*;
@@ -132,6 +133,14 @@ import org.bukkit.event.server.TabCompleteEvent;
 import net.md_5.bungee.api.chat.BaseComponent;
 
 public final class CraftServer implements Server {
+
+    // EMC start
+    @Override
+    public com.empireminecraft.MinecraftKey createKey(@Nonnull String group, @Nonnull String name) {
+        return new net.minecraft.server.MinecraftKey(group, name).getBukkitKey();
+    }
+    // EMC end
+
     private static final Player[] EMPTY_PLAYER_ARRAY = new Player[0];
     private final String serverName = "Paper";
     private final String serverVersion;
-- 
2.10.2

