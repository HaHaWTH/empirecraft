From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: chickeneer <emcchickeneer@gmail.com>
Date: Tue, 3 Aug 2021 14:03:09 -0500
Subject: [PATCH] Detect issues with entity removal

Temporary patch to find async entity removals or rekilling dead entities

diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftEntity.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftEntity.java
index a8424cb0f373a113f500cb4382a3de85c822272b..ee2666315b09f7d5d3d67464bdf5f4c0f821904c 100644
--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftEntity.java
+++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftEntity.java
@@ -755,6 +755,12 @@ public abstract class CraftEntity implements org.bukkit.entity.Entity {
 
     @Override
     public void remove() {
+        if (!org.bukkit.Bukkit.isPrimaryThread()) {
+            new Throwable("Called Async when should be main").printStackTrace();
+        }
+        if (!this.entity.isAlive()) {
+            new Throwable("Entity is already dead...").printStackTrace();
+        }
         this.entity.discard();
     }
 
