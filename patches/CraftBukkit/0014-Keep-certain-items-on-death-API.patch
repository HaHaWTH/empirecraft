From ba0228737f97bdd398a6cf52866abbcac9c2633a Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Mon, 11 Mar 2013 21:05:05 -0400
Subject: [PATCH] Keep certain items on death API

This adds a getItemsToKeep to PlayerDeathEvent that can be modified for what item a player should keep upon death.

This can be used for never-to-be-dropped items.
---
 src/main/java/net/minecraft/server/EntityPlayer.java | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/main/java/net/minecraft/server/EntityPlayer.java b/src/main/java/net/minecraft/server/EntityPlayer.java
index fc06e62..eb5c2ba 100644
--- a/src/main/java/net/minecraft/server/EntityPlayer.java
+++ b/src/main/java/net/minecraft/server/EntityPlayer.java
@@ -275,6 +275,7 @@ public class EntityPlayer extends EntityHuman implements ICrafting {
         }
 
         this.closeInventory();
+        event.getDrops().addAll(this.getBukkitEntity().getInventory().addItem(event.getItemsToKeep().toArray(new org.bukkit.inventory.ItemStack[0])).values()); // EMC
 
         // Update effects on player death
         this.updateEffects = true;
-- 
1.8.1.5

