From 4c5a3237a20a39cda5d8516170b9768d8b373f22 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Thu, 17 Jan 2013 20:36:31 -0500
Subject: [PATCH] Do not check collision on non players

---
 src/main/java/net/minecraft/server/EntityLiving.java  |    1 +
 .../java/net/minecraft/server/EntityMinecart.java     |   17 +++++++++++++++++
 2 files changed, 18 insertions(+)

diff --git a/src/main/java/net/minecraft/server/EntityLiving.java b/src/main/java/net/minecraft/server/EntityLiving.java
index 0056216..3041a9d 100644
--- a/src/main/java/net/minecraft/server/EntityLiving.java
+++ b/src/main/java/net/minecraft/server/EntityLiving.java
@@ -1402,6 +1402,7 @@ public abstract class EntityLiving extends Entity {
     }
 
     protected void bd() {
+        if (!(this instanceof EntityHuman)) { return; } // Spigot - Only check collision on players.
         List list = this.world.getEntities(this, this.boundingBox.grow(0.20000000298023224D, 0.0D, 0.20000000298023224D));
 
         if (list != null && !list.isEmpty()) {
diff --git a/src/main/java/net/minecraft/server/EntityMinecart.java b/src/main/java/net/minecraft/server/EntityMinecart.java
index 712853d..32c2f4f 100644
--- a/src/main/java/net/minecraft/server/EntityMinecart.java
+++ b/src/main/java/net/minecraft/server/EntityMinecart.java
@@ -262,7 +262,24 @@ public class EntityMinecart extends Entity implements IInventory {
         super.b(i);
     }
 
+    // Spigot start - this doesn't happen anymore in EntityLiving
+    protected void checkCollision() {
+        List list = this.world.getEntities(this, this.boundingBox.grow(0.20000000298023224D, 0.0D, 0.20000000298023224D));
+
+        if (list != null && !list.isEmpty()) {
+            for (int i = 0; i < list.size(); ++i) {
+                Entity entity = (Entity) list.get(i);
+
+                if (entity.M()) {
+                    this.collide(entity);
+                }
+            }
+        }
+    }
+
     public void j_() {
+        checkCollision();
+        // Spigot end
         // CraftBukkit start
         double prevX = this.locX;
         double prevY = this.locY;
-- 
1.7.10.4

