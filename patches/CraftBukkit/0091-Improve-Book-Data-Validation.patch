From 5ce2ad082a331304415344732d19515520f47f69 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Fri, 9 Jan 2015 00:53:48 -0500
Subject: [PATCH] Improve Book Data Validation

---
 .../net/minecraft/server/ItemBookAndQuill.java     | 42 ++++++++++++++++++++++
 1 file changed, 42 insertions(+)
 create mode 100644 src/main/java/net/minecraft/server/ItemBookAndQuill.java

diff --git a/src/main/java/net/minecraft/server/ItemBookAndQuill.java b/src/main/java/net/minecraft/server/ItemBookAndQuill.java
new file mode 100644
index 0000000..17e446c
--- /dev/null
+++ b/src/main/java/net/minecraft/server/ItemBookAndQuill.java
@@ -0,0 +1,42 @@
+package net.minecraft.server;
+
+public class ItemBookAndQuill extends Item {
+
+    public ItemBookAndQuill() {
+        this.e(1);
+    }
+
+    public ItemStack a(ItemStack itemstack, World world, EntityHuman entityhuman) {
+        entityhuman.b(itemstack);
+        return itemstack;
+    }
+
+    public boolean s() {
+        return true;
+    }
+
+    public static boolean a(NBTTagCompound nbttagcompound) {
+        if (nbttagcompound == null) {
+            return false;
+        } else if (!nbttagcompound.hasKeyOfType("pages", 9)) {
+            return false;
+        } else {
+            NBTTagList nbttaglist = nbttagcompound.getList("pages", 8);
+            if (nbttaglist.size() > 50) { return false; } // EMC
+
+            for (int i = 0; i < nbttaglist.size(); ++i) {
+                String s = nbttaglist.getString(i);
+
+                if (s == null) {
+                    return false;
+                }
+
+                if (s.length() > 256) {
+                    return false;
+                }
+            }
+
+            return true;
+        }
+    }
+}
-- 
1.9.1

