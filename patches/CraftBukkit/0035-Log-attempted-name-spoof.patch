From 54d06d310f17703630288a0093b5b63787c791f9 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Mon, 9 Sep 2013 19:40:55 -0400
Subject: [PATCH] Log attempted name spoof

---
 src/main/java/net/minecraft/server/PendingConnection.java | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/main/java/net/minecraft/server/PendingConnection.java b/src/main/java/net/minecraft/server/PendingConnection.java
index b098745..0b59471 100644
--- a/src/main/java/net/minecraft/server/PendingConnection.java
+++ b/src/main/java/net/minecraft/server/PendingConnection.java
@@ -70,6 +70,7 @@ public class PendingConnection extends Connection {
     public void a(Packet2Handshake packet2handshake) {
         if (this.g != null) {
             this.disconnect("Quit repeating yourself!");
+            System.err.println("Name Spoof Attempt (actual: " + this.g + ", spoofed: " + packet2handshake.f() +")"); // EMC
         } else {
             this.g = packet2handshake.f();
             if (!this.g.equals(StripColor.a(this.g)) || !validName.matcher( this.g ).matches() ) { // Spigot
-- 
1.8.4

