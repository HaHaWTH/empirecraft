From 63291eed11fd10379a9b8d2f2909f53735cee936 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Mon, 9 Sep 2013 19:40:55 -0400
Subject: [PATCH] Log attempted name spoof

---
 src/main/java/net/minecraft/server/PendingConnection.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/main/java/net/minecraft/server/PendingConnection.java b/src/main/java/net/minecraft/server/PendingConnection.java
index a5c3104..7458f10 100644
--- a/src/main/java/net/minecraft/server/PendingConnection.java
+++ b/src/main/java/net/minecraft/server/PendingConnection.java
@@ -70,7 +70,8 @@ public class PendingConnection extends Connection {
     public void a(Packet2Handshake packet2handshake) {
         // CraftBukkit start
         if (this.g != null) {
-            this.disconnect("Invalid username " + this.g);
+            this.disconnect("Invalid username (actual: " + this.g + ", spoofed: " + packet2handshake.f()); // EMC
+            return; // EMC
         }
         this.hostname = packet2handshake.c == null ? "" : packet2handshake.c + ':' + packet2handshake.d;
         // CraftBukkit end
-- 
1.8.4

