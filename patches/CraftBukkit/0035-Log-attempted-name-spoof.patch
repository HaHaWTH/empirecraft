From 44f864473ed4287e49da3a423e1e32e6a111e338 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Mon, 9 Sep 2013 19:40:55 -0400
Subject: [PATCH] Log attempted name spoof

---
 src/main/java/net/minecraft/server/PendingConnection.java | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/main/java/net/minecraft/server/PendingConnection.java b/src/main/java/net/minecraft/server/PendingConnection.java
index 358cba4..e8a67bd 100644
--- a/src/main/java/net/minecraft/server/PendingConnection.java
+++ b/src/main/java/net/minecraft/server/PendingConnection.java
@@ -69,6 +69,7 @@ public class PendingConnection extends Connection {
     private static final java.util.regex.Pattern validName = java.util.regex.Pattern.compile("^[a-zA-Z0-9_-]{2,16}$"); // Spigot
     public void a(Packet2Handshake packet2handshake) {
         if (this.g != null) {
+            System.err.println("Name Spoof Attempt (actual: " + this.g + ", spoofed: " + packet2handshake.f() +") " + this.getSocket().getInetAddress().getHostAddress()); // EMC
             this.disconnect("Quit repeating yourself!");
         } else {
             this.hostname = packet2handshake.c + ':' + packet2handshake.d; // CraftBukkit - initialize field
-- 
1.8.4

