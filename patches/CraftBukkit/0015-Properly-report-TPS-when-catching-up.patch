From 4d672bef05e90b0242eb8f92a0afe9604c13de80 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Sun, 26 May 2013 20:36:47 -0400
Subject: [PATCH] Properly report TPS when catching up

---
 src/main/java/net/minecraft/server/MinecraftServer.java | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/main/java/net/minecraft/server/MinecraftServer.java b/src/main/java/net/minecraft/server/MinecraftServer.java
index 76c4158..e80df75 100644
--- a/src/main/java/net/minecraft/server/MinecraftServer.java
+++ b/src/main/java/net/minecraft/server/MinecraftServer.java
@@ -397,7 +397,9 @@ public abstract class MinecraftServer implements ICommandListener, Runnable, IMo
                         catchupTime = 0;
                         continue;
                     } else {
-                        catchupTime = Math.min(TICK_TIME * TPS, Math.abs(wait));
+                        long left = Math.abs(wait);
+                        lastTick -= Math.min(TICK_TIME, left);
+                        catchupTime = Math.min(TICK_TIME * TPS, left);
                     }
                     currentTPS = (currentTPS * 0.95) + (1E9 / (curTime - lastTick) * 0.05);
                     lastTick = curTime;
-- 
1.8.3

