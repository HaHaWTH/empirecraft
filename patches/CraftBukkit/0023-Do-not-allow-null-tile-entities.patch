From 44b401bf22556f2b5a5ffc7cee7ecb5333aa69d3 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Tue, 2 Jul 2013 22:46:20 -0400
Subject: [PATCH] Do not allow null tile entities

---
 src/main/java/net/minecraft/server/World.java | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/src/main/java/net/minecraft/server/World.java b/src/main/java/net/minecraft/server/World.java
index f21a192..4b4715e 100644
--- a/src/main/java/net/minecraft/server/World.java
+++ b/src/main/java/net/minecraft/server/World.java
@@ -32,7 +32,16 @@ public abstract class World implements IBlockAccess {
     public boolean d = false;
     public List entityList = new ArrayList();
     protected List f = new ArrayList();
-    public Set tileEntityList = new HashSet(); // CraftBukkit - ArrayList -> HashSet
+    public Set tileEntityList = new HashSet() { // EMC start
+	    @Override
+	    public boolean add(Object o) {
+		    if (o == null) {
+			    new Throwable("Something tried to add a null tile entity").printStackTrace();
+			    return false;
+		    }
+		    return super.add(o);
+	    }}; // CraftBukkit - ArrayList -> HashSet
+	// EMC stop
     private List a = new ArrayList();
     private List b = new ArrayList();
     public List players = new ArrayList();
-- 
1.8.3.2

