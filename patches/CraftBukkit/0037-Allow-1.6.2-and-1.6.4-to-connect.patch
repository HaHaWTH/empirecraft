From cefced7ea7a6433050afcf7bde8ef219074c8e8a Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Thu, 19 Sep 2013 22:28:29 -0400
Subject: [PATCH] Allow 1.6.2 and 1.6.4 to connect

---
 src/main/java/net/minecraft/server/PendingConnection.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/main/java/net/minecraft/server/PendingConnection.java b/src/main/java/net/minecraft/server/PendingConnection.java
index e8a67bd..005681e 100644
--- a/src/main/java/net/minecraft/server/PendingConnection.java
+++ b/src/main/java/net/minecraft/server/PendingConnection.java
@@ -79,7 +79,7 @@ public class PendingConnection extends Connection {
             } else {
                 PublicKey publickey = this.server.H().getPublic();
 
-                if (packet2handshake.d() != 78) {
+                if (packet2handshake.d() < 74) { // EMC
                     if (packet2handshake.d() > 78) {
                         this.disconnect(org.spigotmc.SpigotConfig.outdatedServerMessage); // Spigot
                     } else {
@@ -160,7 +160,7 @@ public class PendingConnection extends Connection {
                 s = pingEvent.getMotd() + "\u00A7" + playerlist.getPlayerCount() + "\u00A7" + pingEvent.getMaxPlayers();
             } else {
                 // CraftBukkit start - Don't create a list from an array
-                Object[] list = new Object[] { 1, 78, this.server.getVersion(), pingEvent.getMotd(), playerlist.getPlayerCount(), pingEvent.getMaxPlayers() };
+                Object[] list = new Object[] { 1, packet254getinfo.a > 73 && packet254getinfo.a < 79 ? packet254getinfo.a : 78, this.server.getVersion(), pingEvent.getMotd(), playerlist.getPlayerCount(), pingEvent.getMaxPlayers() }; // EMC
 
                 StringBuilder builder = new StringBuilder();
                 for (Object object : list) {
-- 
1.8.4

