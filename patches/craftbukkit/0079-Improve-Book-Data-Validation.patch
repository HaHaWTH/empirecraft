From b79e42a60712651237bf6f37afd0511fc45d2f81 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Fri, 9 Jan 2015 00:53:48 -0500
Subject: [PATCH] Improve Book Data Validation

---
 src/main/java/net/minecraft/server/ItemBookAndQuill.java | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/main/java/net/minecraft/server/ItemBookAndQuill.java b/src/main/java/net/minecraft/server/ItemBookAndQuill.java
index a345507..048f010 100644
--- a/src/main/java/net/minecraft/server/ItemBookAndQuill.java
+++ b/src/main/java/net/minecraft/server/ItemBookAndQuill.java
@@ -19,6 +19,7 @@ public class ItemBookAndQuill extends Item {
             return false;
         } else {
             NBTTagList nbttaglist = nbttagcompound.getList("pages", 8);
+            if (nbttaglist.size() > 50) { return false; } // EMC
 
             for (int i = 0; i < nbttaglist.size(); ++i) {
                 String s = nbttaglist.getString(i);
-- 
1.9.1

