From 79dfeffd3015ed0b8b9890738747849937ff5173 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Sat, 19 Sep 2015 01:22:21 -0400
Subject: [PATCH] Safeguard Chunk add/removeEntities from being double called

---
 src/main/java/net/minecraft/server/Chunk.java | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/main/java/net/minecraft/server/Chunk.java b/src/main/java/net/minecraft/server/Chunk.java
index 66e1f33..faab827 100644
--- a/src/main/java/net/minecraft/server/Chunk.java
+++ b/src/main/java/net/minecraft/server/Chunk.java
@@ -808,6 +808,7 @@ public class Chunk {
     }
 
     public void addEntities() {
+        if (this.h) { return; } // PAIL: entitiesAdded // CraftBukkit - don't double load entities
         this.h = true;
         this.world.a(this.tileEntities.values());
 
@@ -826,6 +827,7 @@ public class Chunk {
     }
 
     public void removeEntities() {
+        if (!this.h) { return; } // PAIL: entitiesAdded // CraftBukkit - don't double unload entities
         this.h = false;
         Iterator iterator = this.tileEntities.values().iterator();
 
-- 
1.9.1

