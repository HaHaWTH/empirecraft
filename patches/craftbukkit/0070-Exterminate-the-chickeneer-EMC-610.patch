From 2c27aea2c3886a8115958976cffb0fc6b119d1cc Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Sun, 19 Oct 2014 02:32:26 -0400
Subject: [PATCH] Exterminate the chickeneer - EMC-610

Wipe out chickens when the Jockey is killed.
---
 src/main/java/net/minecraft/server/EntityChicken.java |  6 ++++++
 src/main/java/net/minecraft/server/EntityZombie.java  | 10 ++++++++++
 2 files changed, 16 insertions(+)

diff --git a/src/main/java/net/minecraft/server/EntityChicken.java b/src/main/java/net/minecraft/server/EntityChicken.java
index 4268d3a..2d3e995 100644
--- a/src/main/java/net/minecraft/server/EntityChicken.java
+++ b/src/main/java/net/minecraft/server/EntityChicken.java
@@ -121,6 +121,12 @@ public class EntityChicken extends EntityAnimal {
         return this.isChickenJockey() ? 10 : super.getExpValue(entityhuman);
     }
 
+    // EMC start
+    public boolean d(NBTTagCompound nbttagcompound) {
+        return (!(isChickenJockey() && passenger == null)) && super.d(nbttagcompound);
+    }
+    // EMC end
+
     public void b(NBTTagCompound nbttagcompound) {
         super.b(nbttagcompound);
         nbttagcompound.setBoolean("IsChickenJockey", this.bt);
diff --git a/src/main/java/net/minecraft/server/EntityZombie.java b/src/main/java/net/minecraft/server/EntityZombie.java
index ed9486e..ce5ae0d 100644
--- a/src/main/java/net/minecraft/server/EntityZombie.java
+++ b/src/main/java/net/minecraft/server/EntityZombie.java
@@ -381,6 +381,16 @@ public class EntityZombie extends EntityMonster {
         return itemstack.getItem() == Items.EGG && this.isBaby() && this.au() ? false : super.a(itemstack);
     }
 
+    // EMC start
+    @Override
+    public void die(DamageSource damagesource) {
+        if (passenger instanceof EntityChicken) {
+            ((EntityLiving) passenger).die(damagesource);
+        }
+        super.die(damagesource);
+    }
+    // EMC end
+
     public GroupDataEntity prepare(DifficultyDamageScaler difficultydamagescaler, GroupDataEntity groupdataentity) {
         Object object = super.prepare(difficultydamagescaler, groupdataentity);
         float f = difficultydamagescaler.c();
-- 
1.9.1

